{
  "id": "11701c17-b2fc-44bc-a23c-0cba5aa36392",
  "prefix": "buildpushnaptienviettelpay",
  "description": "Build bảng push nạp tiền ViettelPay",
  "body": "INSERT INTO dbo.CRM_POS_COLLECTION_ON_BEHALF_PUSH\n    (\n         CRMID\n       , CRMCode\n       , VendorCode\n       , TotalAmount\n       , Fee\n       , CreateDate\n       , U_ShpCod\n       , U_CrdCod\n       , U_EplCod\n       , U_Desc\n       , U_MoCash\n       , U_MoCCad\n       , U_Acbank\n       , U_CTLKCode\n       , U_TypCre\n       , U_NumCre\n       , U_MoVoCh\n       , U_NumVch\n       , U_NaVoch\n       , U_AcVoch\n       , U_MoTran\n       , U_BankTs\n       , U_AccNum\n       , U_AccName\n       , IsAutoCard\n       , Card_Fee\n       , CardFeeTM\n       , LongChauShopCode\n       , UpdatedDate\n       , PushStatus\n       , POSMsg\n       , POSORCT\n       , MaChuanChi\n       , SplitFee\n       , SplitFeeType\n       , mPOSDocNum\n       , Status\n       , ServiceName\n       , ReceiverPersionID\n       , SenderPersionID\n       , Phone\n    )\nSELECT\n      P.ID\n\t, CONVERT(VARCHAR, P.ID)\n\t, '0041'\n\t, P.U_Tmoney\n\t, P.U_Fee\n\t, P.CreateDate\n\t, P.From_ShopCode\n\t, 0\n\t, ''\n\t, ''\n\t, ISNULL(P.U_Tmoney, 0) + ISNULL(P.U_Fee, 0)\n\t, 0\n\t, ''\n\t, ''\n\t, ''\n\t, ''\n\t, 0\n\t, ''\n\t, ''\n\t, ''\n\t, 0\n\t, ''\n\t, ''\n\t, ''\n\t, 'N'\n\t, 0\n\t, 0\n\t, ''\n\t, NULL\n\t, 1\n\t, NULL\n\t, NULL\n\t, ''\n\t, CASE WHEN P.Pay_Type = 1 THEN 1 ELSE 0 END\n\t, 0\n\t, P.Mpos_ID\n\t, P.U_status\n\t, CASE WHEN P.Pay_Type = 1 THEN N'Chuyển tiền ViettelPay' WHEN P.Pay_Type = 3 THEN N'Nạp tiền' END\n\t, P.CardID_Receiver\n\t, P.CardID_Sender\n\t, P.U_Phone_Sender\nFROM\n    dbo.Pay_Services P (NOLOCK)\nWHERE\n    P.ID IN ($CURSOR$)\n    AND P.Pay_Type = 3\n"
}