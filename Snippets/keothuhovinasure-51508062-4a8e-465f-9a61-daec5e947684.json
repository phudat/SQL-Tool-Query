{
  "id": "51508062-4a8e-465f-9a61-daec5e947684",
  "prefix": "keothuhovinasure",
  "description": "kéo thu hộ Vinasure",
  "body": "INSERT INTO dbo.POSPaymentMethod\n    (\n         CreatedDate\n       , CreatedBy\n       , Remark\n       , CashAmount\n       , PaymentType\n       , VinasureID\n       , TypePaymentVendor\n    )\nSELECT \n\t  V.CreatedDateTime\n\t, V.CreatedBy\n\t, N'Thanh toán bằng tiền mặt'\n\t, ISNULL(V.Amount, 0)\n\t, 'CASH'\n\t, V.ID\n\t, 1\nFROM \n\tdbo.VinasureHeader V (NOLOCK) \nWHERE \n\tV.Id IN (\n$vinasureid$\n)\n\nINSERT INTO dbo.CashCollectionReceiptsNoVAT\n    (\n         ReceiptCode\n       , ReceiptDate\n       , WarehouseCode\n       , VendorCode\n       , RefCode\n       , CustomerCode\n       , CustomerName\n       , MobilePhoneNumber\n       , Amount\n       , CashCollectionReceiptsNoVATType\n       , CashCollectionReceiptsNoVATStatus\n       , Remark\n       , CreatedDateTime\n       , CreatedEmployeeBy\n       , IsConfirmed\n       , ConfirmedDate\n       , ConfirmedEmployeeBy\n       , CardPaymentFee\n    )\nSELECT \n\t'BH-' + CONVERT(VARCHAR, GETDATE(), 112) + CONVERT(VARCHAR, P.ID)\n\t, P.CreatedDateTime\n\t, P.WarehouseCode\n\t, P.VendorCode\n\t, CONVERT(VARCHAR, P.ID)\n\t, ''\n\t, P.buyer_name\n\t, P.buyer_mobile\n\t, P.Amount\n\t, 343\n\t, 298\n\t, N'Hệ thống tạo'\n\t, P.CreatedDateTime\n\t, P.CreatedBy\n\t, 1\n\t, P.CreatedDateTime\n\t, 'SYSTEM'\n\t, 0\nFROM \n\tdbo.VinasureHeader P (NOLOCK) \nWHERE \n\tP.ID IN (\n$vinasureid$\n)\n\nINSERT INTO dbo.CRM_POS_COLLECTION_ON_BEHALF_PUSH\n    (\n         CRMID\n       , CRMCode\n       , VendorCode\n       , TotalAmount\n       , Fee\n       , CreateDate\n       , U_ShpCod\n       , U_CrdCod\n       , U_EplCod\n       , U_Desc\n       , U_MoCash\n       , U_MoCCad\n       , U_Acbank\n       , U_CTLKCode\n       , U_TypCre\n       , U_NumCre\n       , U_MoVoCh\n       , U_NumVch\n       , U_NaVoch\n       , U_AcVoch\n       , U_MoTran\n       , U_BankTs\n       , U_AccNum\n       , U_AccName\n       , IsAutoCard\n       , Card_Fee\n       , CardFeeTM\n       , LongChauShopCode\n       , UpdatedDate\n       , PushStatus\n       , POSMsg\n       , POSORCT\n       , MaChuanChi\n       , SplitFee\n       , SplitFeeType\n       , mPOSDocNum\n       , Status\n    )\nSELECT\n    V.ID\n\t, V.ID\n\t, V.VendorCode\n\t, V.Amount\n\t, 0\n\t, V.CreatedDateTime\n\t, V.WarehouseCode\n\t, 0\n\t, V.CreatedBy\n\t, ''\n\t, P.CashAmount\n\t, P.CardAmount\n\t, P.CardPaymentMethod\n\t, P.U_CTLKCode\n\t, P.CreditCardType\n\t, P.CreditCardNumber\n\t, P.VoucherAmount\n\t, P.VoucherNumber\n\t, P.VoucherName\n\t, P.VoucherAccount\n\t, P.TransferAmount\n\t, P.BankCode\n\t, P.BankAccountNumber\n\t, P.BankAccountName\n\t, CASE WHEN P.IsAutoCard = 1 THEN 'Y' ELSE 'N' END\n\t, P.Card_Fee\n\t, P.Card_Fee\n\t, ''\n\t, NULL\n\t, 1\n\t, NULL\n\t, NULL\n\t, P.CreditCardNumber\n\t, 0\n\t, 0\n\t, NULL\n\t, V.VinasureStatus\nFROM\n    dbo.VinasureHeader V (NOLOCK)\n\t\tINNER JOIN dbo.POSPaymentMethod P (NOLOCK)\n\t\t\tON V.ID = P.VinasureID\nWHERE\n\tV.ID IN (\n$vinasureid$\n)\n\nSELECT * FROM FRTCRM.dbo.CRM_POS_COLLECTION_ON_BEHALF_PUSH WITH (NOLOCK) WHERE CRMID IN ($vinasureid$)\n\nRETURN\t\nEXEC [10.1.13.71].FRT_POS.dbo.sp_POS_CRMv2_CollectionOnBeHalf_AllInOne \n\t@IDList = '$vinasureid$', -- varchar(max)\n    @VendorCode = '0042', -- varchar(40)\n    @ShopCode = '', -- varchar(40)\n    @ConfirmedDate = '2019-06-30 14:38:10', -- date\n    @POSDate       = '2019-06-30 14:38:10' -- date\n",
  "placeholders": [
    {
      "name": "vinasureid",
      "defaultValue": ""
    }
  ]
}