{
  "id": "c4d6968f-6939-46bf-997b-bfddd559af37",
  "prefix": "hotroviettel_chi",
  "description": "hỗ trợ cho các giao dịch chi tiền thất bại",
  "body": "DECLARE @OrderId VARCHAR(50)='$CURSOR$'\r\nDECLARE @orderStatus VARCHAR(50)='FAILED'\r\nDECLARE @Description NVARCHAR(250)=N'Quy trình thực hiện : 209321'\r\nUPDATE [SOM-Order-Service].dbo.[Order] set OrderStatus = @orderStatus  where Id = @OrderId\r\n\tINSERT INTO [SOM-Order-Service].dbo.OrderHistory\r\n\t(\r\n\t    Id,\r\n\t    CreationTime,\r\n\t    CreationBy,\r\n\t    OrderId,\r\n\t    Action,\r\n\t    Remark,\r\n\t    Description,\r\n\t    CreationTimeOffset,\r\n\t    LastModificationTimeOffset\r\n\t)\r\n\tVALUES\r\n\t(   NEWID(),                -- Id - uniqueidentifier\r\n\t    NULL,       -- CreationTime - datetime2(7)\r\n\t    N'owner',                 -- CreationBy - nvarchar(max)\r\n\t    @OrderId,                -- OrderId - uniqueidentifier\r\n\t    @orderStatus,                 -- Action - nvarchar(max)\r\n\t    NULL,                 -- Remark - nvarchar(max)\r\n\t    @Description,                 -- Description - nvarchar(max)\r\n\t    SYSDATETIMEOFFSET(), -- CreationTimeOffset - datetimeoffset(7)\r\n\t    NULL  -- LastModificationTimeOffset - datetimeoffset(7)\r\n\t    )\r\nDECLARE @es NVARCHAR(500) =N'POST /frt_som_order_alias/_update/'+@OrderId+N'<br/>{ \"script\": { \"inline\": \"ctx._source.orderStatus ='''+@orderStatus+''';\", \"lang\": \"painless\" } }'\r\nSELECT @es"
}